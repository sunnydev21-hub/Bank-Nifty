import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
import pickle

# Step 1: Prepare Input Data
data = {
    "upcrt": [992, 1047, 1104, 1162, 1226, 1289, 1356, 1427, 1498, 1576, 1291, 1360, 1429, 1504, 1576, 1652, 1733, 1816, 1900, 1988, 693, 732, 773, 816, 859, 908, 955, 1007, 1059, 1114, 1267, 1333, 1401, 1472, 1546, 1621, 1700, 1779, 1864, 816, 867, 920, 973, 1033, 1091, 1151, 1219, 1284, 655, 692, 730, 774, 817, 864, 913, 964, 1020, 728, 779, 831, 886, 946, 1004, 1071, 1136, 1263, 610, 650, 688, 731, 777, 826, 874, 925, 981, 641, 688, 737, 784, 840, 82, 953, 1013, 1077, 624, 665, 710, 755, 804, 857, 910, 968, 1027, 827, 884, 942, 1005, 1070, 1139, 1209, 1284, 1360, 731, 780, 832, 886, 944, 1004, 1067, 1131, 1199, 688, 740, 792, 850, 911, 973, 1039, 1108, 1180, 749, 800, 856, 916, 976, 1041, 1109, 1178, 573, 617, 667, 721, 776, 834, 897, 961, 1027, 923, 996, 1070, 1149, 1232, 1317, 1408, 1497, 1594, 788, 855, 922, 995, 1069, 1150, 1233, 1314, 1405, 930, 1007, 1088, 1172, 1260, 1354, 1447, 1545, 1644, 760, 829, 900, 977, 1057, 1141, 1229, 1322, 1418, 1518, 780, 847, 922, 997, 1084, 1172, 1268, 1363, 1462, 1567, 1673, 1789, 1911, 2032, 2140, 1544, 1725, 1896, 2057, 2208, 2348, 2478, 2597, 2712, 2822, 1295, 1485, 1671, 1852, 2019, 2175, 2332, 2458, 2587, 2700, 784, 826, 869, 911, 959, 1010, 1058, 1110, 1163, 1220, 704, 741, 778, 820, 863, 906, 950, 997, 1044, 1095, 761, 808, 850, 897, 947, 994, 1050, 1102, 1160, 1219, 872, 919, 964, 1011, 1060, 1111, 1163, 1218, 1273, 1331, 797, 842, 885, 931, 979, 1029, 1081, 1131, 1187, 1244, 777, 826, 869, 917, 967, 1018, 1075, 1132, 1191, 1247, 797, 842, 885, 931, 979, 1029, 1081, 1131, 1187, 1244, 970, 1022, 1078, 1133, 1192, 1253, 1315, 1381, 1447, 1518, 638, 676, 717, 758, 802, 846, 895, 943, 991, 1044, 816, 863, 915, 965, 1019, 1075, 1134, 1194, 1258, 1321, 631, 672, 714, 757, 804, 854, 905, 958, 1013, 1072, 720, 765, 812, 863, 916, 970, 1028, 1088, 1151, 1214, 707, 755, 804, 855, 910, 967, 107, 1089, 1151, 1222, 711, 761, 815, 867, 929, 984, 1043, 1100, 1184, 1257, 681, 731, 784, 837, 894, 955, 1017, 1082, 1151, 1222, 790, 858, 930, 1006, 1085, 1163, 1251, 1340, 1426, 1520, 781, 851, 926, 1005, 1088, 1175, 1264, 1358, 1456, 1556, 925, 1012, 1087, 1175, 1260, 1349, 1444, 1536, 1636, 1737, 964, 1050, 1141, 1234, 1332, 1432, 1537, 1641, 1751, 1860, 973, 1078, 1187, 1295, 1410, 1530, 1646, 1769, 1891, 2010, 934, 1046, 1163, 1282, 1407, 1534, 1659, 1793, 1924, 2053, 1035, 1168, 1308, 1448, 1591, 1737, 1872, 2020, 2150, 2283, 805, 853, 903, 954, 1010, 1066, 1126, 1156, 1249, 1318, 820, 867, 915, 1015, 1071, 1125, 1184, 1243, 1302, 790, 835, 883, 934, 988, 1042, 1092, 1155, 1214, 1270, 968, 1024, 1083, 1145, 1208, 1278, 1344, 1415, 1492, 1568],
	
	"lwcrt": [666, 708, 754, 799, 850, 900, 954, 1012, 1070, 1133, 886, 942, 998, 1057, 1119, 1182, 1249, 1319, 1390, 1464, 661, 694, 731, 769, 806, 855, 896, 942, 990, 1040, 862, 913, 968, 1026, 1086, 1147, 1212, 1278, 1349, 1074, 1189, 1310, 1427, 1573, 1707, 1824, 1911, 1982, 930, 973, 1012, 1067, 1117, 1171, 1230, 1286, 1357, 734, 786, 836, 893, 949, 1010, 1083, 1142, 1211, 814, 867, 914, 965, 1023, 1087, 1141, 1203, 1266, 589, 633, 681, 720, 775, 820, 877, 934, 996, 616, 657, 709, 753, 805, 862, 919, 982, 1042, 808, 862, 927, 986, 1056, 1126, 1199, 1278, 1353, 669, 716, 764, 814, 871, 927, 988, 1047, 1111, 616, 668, 714, 771, 830, 889, 956, 1022, 1092, 672, 722, 778, 844, 901, 971, 1043, 1116, 526, 261, 617, 668, 720, 778, 839, 901, 964, 1132, 1282, 1432, 1582, 1684, 1786, 1905, 2006, 2126, 1059, 1167, 1243, 1327, 1414, 1519, 1610, 1699, 1802, 1017, 1092, 1178, 1262, 1346, 1445, 1532, 1633, 1726, 674, 729, 785, 849, 916, 981, 1058, 1140, 1227, 1316, 674, 715, 771, 822, 895, 964, 1045, 1121, 1207, 1294, 1390, 1503, 1619, 1741, 1831, 1501, 1870, 2248, 2644, 3052, 3464, 3731, 3817, 4078, 4125, 713, 889, 1059, 1240, 1419, 1572, 1754, 1882, 2035, 2153, 1149, 1211, 1261, 1304, 1366, 1419, 1481, 1536, 1587, 1658, 650, 683, 718, 760, 800, 843, 884, 931, 975, 1025, 1018, 1079, 1124, 1182, 1241, 1299, 1361, 1422, 1489, 1555, 1273, 1355, 1391, 1445, 1509, 1568, 1644, 1705, 1772, 1830, 1094, 1150, 1204, 1263, 1321, 1382, 1440, 1503, 1575, 1643, 1146, 1214, 1261, 1325, 1386, 1446, 1521, 1591, 1661, 1722, 1094, 1150, 1204, 1263, 1321, 1382, 1440, 1503, 1575, 1643, 1380, 1435, 1520, 1584, 1661, 1743, 1813, 1893, 1973, 2072, 1223, 1293, 1360, 1420, 1501, 1570, 1649, 1720, 1797, 1880, 1071, 1132, 1203, 1265, 1332, 1407, 1480, 1556, 1637, 1716, 585, 625, 662, 703, 750, 798, 848, 899, 952, 1011, 677, 720, 763, 811, 865, 912, 972, 1029, 1091, 1151, 610, 652, 694, 738, 786, 836, 889, 945, 999, 1068, 598, 639, 690, 733, 795, 839, 891, 936, 1032, 1100, 672, 722, 771, 824, 874, 942, 1006, 1080, 1129, 1197, 720, 778, 844, 913, 984, 1047, 1132, 1211, 1282, 1380, 680, 748, 821, 898, 980, 1072, 1158, 1253, 1359, 1465, 1135, 1263, 1347, 1463, 1572, 1668, 1784, 1896, 2017, 2131, 835, 919, 1009, 1097, 1192, 1290, 1392, 1494, 1604, 1707, 1145, 1263, 1380, 1490, 1611, 1746, 1864, 2000, 2132, 2268, 1313, 1501, 1704, 1917, 2158, 2420, 2683, 2983, 2986, 3146, 802, 892, 993, 1092, 1197, 1310, 1418, 1557, 1653, 1770, 933, 983, 1049, 1108, 1175, 1242, 1313, 1387, 1455, 1542, 1220, 1288, 1360, 1492, 1569, 1642, 1731, 1805, 1882, 741, 779, 827, 877, 931, 984, 1036, 1091, 1149, 1213, 1473, 1527, 1601, 1679, 1748, 1836, 1917, 1998, 2091, 2180],
	
	"open": [248, 255, 275, 305, 380, 380, 410, 423, 463, 501, 302, 331, 374, 396, 440, 480, 541, 586, 612, 700, 270, 291, 305, 325, 348, 375, 399, 486, 453, 490, 308, 314, 349, 389, 410, 440, 500, 544, 579, 260, 301, 347, 372, 380, 413, 436, 490, 529, 266, 281, 299, 323, 345, 299, 385, 429, 476, 200, 235, 259, 350, 323, 339, 379, 433, 475, 246, 246, 264, 308, 303, 345, 382, 431, 426, 236, 190, 244, 262, 295, 319, 336, 368, 424, 220, 235, 266, 284, 324, 316, 362, 390, 414, 270, 288, 298, 338, 380, 420, 460, 500, 534, 293, 299, 329, 331, 381, 420, 442, 480, 515, 157, 190, 199, 255, 286, 317, 328, 369, 409, 258, 290, 319, 354, 380, 417, 462, 544, 124, 150, 159, 180, 200, 232, 153, 286, 305, 282, 313, 314, 380, 438, 500, 545, 566, 610, 233, 289, 300, 351, 390, 388, 472, 524, 550, 150, 317, 340, 369, 386, 479, 450, 569, 619, 220, 235, 250, 313, 341, 390, 415, 481, 556, 550, 131, 138, 155, 172, 200, 215, 301, 226, 273, 274, 369, 437, 440, 490, 544, 336, 440, 529, 646, 720, 815, 905, 965, 1055, 1206, 229, 340, 439, 523, 615, 714, 790, 900, 1000, 1100, 322, 347, 380, 450, 453, 453, 494, 525, 559, 610, 283, 315, 339, 398, 366, 449, 439, 420, 500, 541, 201, 303, 299, 333, 301, 400, 437, 451, 492, 565, 381, 410, 420, 479, 501, 526, 544, 625, 636, 699, 343, 363, 392, 400, 434, 460, 495, 520, 580, 580, 307, 352, 388, 410, 420, 458, 510, 483, 570, 633, 343, 363, 392, 400, 434, 460, 495, 520, 580, 580, 380, 426, 422, 500, 530, 560, 600, 635, 688, 736, 279, 267, 339, 358, 356, 336, 437, 437, 484, 441, 330, 330, 386, 402, 439, 470, 508, 540, 585, 618, 199, 240, 270, 280, 314, 353, 360, 400, 428, 464, 271, 288, 327, 363, 375, 405, 465, 469, 504, 541, 206, 205, 300, 324, 274, 351, 401, 351, 490, 425, 248, 269, 334, 310, 347, 399, 422, 432, 463, 540, 199, 218, 222, 261, 285, 250, 332, 420, 355, 449, 334, 354, 425, 453, 515, 511, 578, 640, 670, 760, 277, 300, 337, 380, 398, 492, 449, 536, 615, 643, 370, 363, 425, 418, 501, 570, 641, 679, 746, 762, 320, 340, 411, 427, 511, 551, 612, 555, 700, 813, 200, 250, 280, 324, 350, 400, 450, 510, 566, 602, 162, 189, 233, 264, 286, 311, 371, 333, 510, 572, 286, 362, 391, 474, 498, 548, 613, 692, 761, 827, 225, 295, 340, 274, 330, 370, 399, 501, 490, 505, 287, 301, 350, 475, 439, 413, 466, 478, 639, 344, 328, 358, 407, 420, 424, 430, 554, 580, 582, 399, 436, 475, 515, 560, 606, 650, 690, 737, 797],
	
    "high": [329, 363, 399, 437, 478, 522, 467, 614, 661, 715, 543, 588, 638, 687, 748, 793, 851, 908, 968, 1030, 286, 305, 325, 347, 370, 394, 420, 486, 475, 506, 479, 521, 526, 609, 658, 708, 760, 815, 871, 324, 355, 389, 426, 462, 504, 547, 593, 639, 285, 303, 321, 341, 363, 389, 413, 441, 476, 263, 292, 322, 354, 388, 426, 466, 508, 552, 272, 291, 312, 335, 359, 386, 414, 444, 476, 236, 244, 271, 298, 328, 360, 396, 433, 472, 249, 268, 288, 309, 332, 355, 384, 390, 445, 270, 288, 318, 352, 389, 428, 471, 515, 562, 293, 320, 348, 378, 412, 447, 486, 526, 570, 202, 227, 254, 284, 317, 353, 392, 433, 478, 279, 306, 329, 375, 399, 434, 471, 560, 146, 167, 190, 216, 245, 277, 312, 350, 391, 357, 400, 442, 489, 539, 593, 649, 709, 773, 326, 359, 394, 434, 476, 522, 571, 624, 679, 287, 323, 360, 402, 445, 494, 544, 598, 656, 262, 291, 321, 355, 390, 429, 471, 517, 566, 618, 146, 157, 172, 192, 235, 244, 301, 174, 355, 398, 450, 502, 561, 623, 689, 368, 459, 553, 653, 747, 848, 916, 1016, 1113, 1230, 414, 509, 603, 700, 795, 895, 987, 1086, 1188, 1288, 358, 387, 419, 451, 487, 524, 563, 605, 647, 692, 283, 361, 339, 410, 438, 462, 489, 521, 553, 585, 291, 315, 340, 367, 397, 427, 468, 493, 529, 568, 425, 453, 482, 511, 542, 576, 610, 648, 686, 728, 384, 409, 438, 465, 498, 525, 557, 590, 625, 662, 351, 382, 410, 441, 471, 505, 577, 574, 619, 658, 384, 409, 438, 465, 498, 525, 557, 590, 625, 662, 404, 438, 472, 509, 547, 587, 630, 701, 720, 768, 279, 295, 339, 358, 356, 377, 441, 433, 491, 485, 330, 353, 386, 407, 439, 473, 509, 547, 589, 627, 222, 240, 270, 281, 315, 353, 360, 426, 428, 464, 273, 296, 327, 363, 375, 428, 465, 479, 506, 543, 278, 301, 326, 353, 380, 410, 441, 476, 511, 550, 339, 367, 399, 431, 466, 503, 543, 585, 631, 678, 199, 218, 222, 265, 285, 305, 332, 450, 395, 449, 370, 406, 445, 484, 528, 574, 622, 675, 729, 830, 308, 345, 385, 429, 475, 527, 580, 637, 697, 759, 443, 488, 534, 583, 637, 694, 756, 816, 882, 951, 394, 446, 498, 558, 617, 682, 748, 820, 895, 969, 295, 338, 385, 437, 492, 551, 613, 679, 749, 821, 162, 245, 259, 277, 297, 326, 419, 478, 544, 605, 378, 430, 486, 546, 612, 675, 745, 820, 896, 975, 299, 320, 347, 375, 405, 438, 471, 523, 543, 583, 315, 337, 364, 475, 439, 463, 492, 524, 639, 399, 427, 456, 489, 520, 555, 591, 627, 667, 709, 430, 466, 503, 543, 585, 639, 676, 723, 780, 826],
	
	"low": [220, 250, 275, 300, 327, 354, 385, 422, 460, 501, 296, 328, 353, 394, 429, 469, 511, 555, 602, 643, 184, 196, 208, 221, 236, 251, 266, 283, 300, 321, 249, 271, 297, 324, 353, 382, 413, 448, 485, 174, 193, 213, 233, 256, 277, 306, 333, 364, 205, 219, 262, 250, 268, 286, 306, 327, 350, 173, 194, 215, 236, 262, 288, 318, 349, 382, 194, 208, 223, 239, 256, 276, 295, 316, 340, 157, 175, 194, 215, 238, 262, 290, 38, 349, 169, 183, 197, 213, 231, 250, 270, 300, 318, 186, 208, 230, 255, 285, 314, 351, 387, 425, 204, 222, 243, 266, 290, 317, 246, 377, 411, 143, 161, 179, 202, 225, 253, 280, 311, 343, 201, 220, 242, 265, 291, 318, 349, 382, 58, 65, 71, 79, 88, 98, 109, 120, 134, 233, 263, 297, 333, 372, 415, 461, 511, 564, 198, 221, 247, 275, 306, 341, 377, 418, 461, 136, 151, 167, 187, 208, 231, 255, 281, 310, 125, 137, 147, 160, 172, 187, 203, 233, 241, 262, 82, 89, 97, 108, 120, 135, 153, 312, 198, 225, 257, 292, 332, 376, 425, 186, 264, 350, 441, 535, 627, 726, 824, 935, 1027, 215, 304, 394, 486, 585, 678, 780, 880, 970, 1099, 277, 300, 324, 351, 379, 408, 439, 473, 508, 545, 206, 220, 234, 250, 266, 283, 301, 321, 341, 362, 199, 266, 268, 288, 301, 337, 364, 392, 422, 453, 301, 320, 340, 362, 385, 409, 435, 460, 488, 517, 237, 254, 269, 288, 307, 328, 349, 371, 395, 421, 306, 352, 357, 385, 400, 445, 478, 483, 548, 587, 237, 254, 269, 288, 307, 328, 349, 371, 395, 421, 237, 258, 279, 302, 328, 353, 380, 410, 441, 472, 166, 178, 192, 205, 221, 237, 254, 273, 291, 315, 170, 185, 201, 216, 236, 256, 278, 301, 325, 351, 148, 161, 175, 190, 207, 223, 242, 262, 282, 306, 132, 141, 155, 167, 182, 199, 216, 234, 255, 276, 150, 162, 175, 189, 205, 221, 240, 260, 275, 305, 218, 234, 255, 278, 301, 326, 353, 379, 403, 443, 137, 149, 163, 177, 194, 211, 229, 248, 270, 293, 163, 181, 202, 223, 248, 275, 304, 336, 371, 409, 166, 191, 219, 249, 281, 320, 360, 405, 453, 505, 277, 308, 341, 378, 417, 460, 507, 557, 609, 606, 161, 187, 215, 247, 282, 322, 365, 411, 463, 517, 156, 184, 216, 251, 291, 335, 383, 433, 489, 550, 42, 51, 60, 72, 86, 103, 122, 144, 170, 198, 181, 218, 261, 306, 358, 413, 474, 537, 606, 680, 223, 244, 266, 274, 312, 336, 363, 392, 422, 453, 189, 203, 217, 250, 268, 287, 306, 327, 387, 307, 328, 358, 377, 412, 410, 473, 460, 520, 566, 351, 382, 414, 448, 485, 527, 562, 606, 647, 694]
}

# Create a DataFrame from the data
df = pd.DataFrame(data)

# Model for HIGH
inputs_high = df[['upcrt', 'open']].values
results_high = df['high'].values
model_high = LinearRegression()
model_high.fit(inputs_high, results_high)

# Evaluate HIGH model
high_predictions = model_high.predict(inputs_high)
high_mse = mean_squared_error(results_high, high_predictions)
print(f'Mean Squared Error for HIGH model: {high_mse}')
print(f'HIGH Model Coefficients: {model_high.coef_}')
print(f'HIGH Model Intercept: {model_high.intercept_}')

# Save the HIGH model
with open('linear_regression_model_high.pkl', 'wb') as f:
    pickle.dump(model_high, f)

# Model for LOW
inputs_low = df[['lwcrt', 'open']].values
results_low = df['low'].values
model_low = LinearRegression()
model_low.fit(inputs_low, results_low)

# Evaluate LOW model
low_predictions = model_low.predict(inputs_low)
low_mse = mean_squared_error(results_low, low_predictions)
print(f'Mean Squared Error for LOW model: {low_mse}')
print(f'LOW Model Coefficients: {model_low.coef_}')
print(f'LOW Model Intercept: {model_low.intercept_}')

# Save the LOW model
with open('linear_regression_model_low.pkl', 'wb') as f:
    pickle.dump(model_low, f)

print("Models trained, evaluated, and saved successfully!")